
# Домашнее задание к занятию 4 «Оркестрация группой Docker контейнеров на примере Docker Compose»

### Инструкция к выполению

1. Для выполнения заданий обязательно ознакомьтесь с [инструкцией](https://github.com/netology-code/devops-materials/blob/master/cloudwork.MD) по экономии облачных ресурсов. Это нужно, чтобы не расходовать средства, полученные в результате использования промокода.
2. Практические задачи выполняйте на личной рабочей станции или созданной вами ранее ВМ в облаке.
3. Своё решение к задачам оформите в вашем GitHub репозитории в формате markdown!!!
4. В личном кабинете отправьте на проверку ссылку на .md-файл в вашем репозитории.

## Задача 1 Решение

[Dockerhub](https://hub.docker.com/r/rabbitvlad/nginx-custom/tags)



## Задача 2
1. Запустите ваш образ custom-nginx:1.0.0 командой docker run в соответвии с требованиями:
..........................................................................................
4. Убедитесь с помощью curl или веб браузера, что индекс-страница доступна.

В качестве ответа приложите скриншоты консоли, где видно все введенные команды и их вывод.

## Задача 2 Решение

![Задача 2](https://github.com/vladrabbit/docker/blob/main/img/docker-1.png)




## Задача 3
1. Воспользуйтесь docker help или google, чтобы узнать как подключиться к стандартному потоку ввода/вывода/ошибок контейнера "custom-nginx-t2".
................................................................................................................................................
12. Удалите запущенный контейнер "custom-nginx-t2", не останавливая его.(воспользуйтесь --help или google)

В качестве ответа приложите скриншоты консоли, где видно все введенные команды и их вывод.

## Задача 3 Решение

3. Выполните ```docker ps -a``` и объясните своими словами почему контейнер остановился.
   - Контейнер nginx запускает основной процесс (PID 1) — nginx.
   - При выполнении docker attach и нажатии Ctrl+C, отправляется SIGINT (прерывание) основному процессу.
   - Так как nginx — единственный процесс, контейнер завершает работу.

![Задача 3](https://github.com/vladrabbit/docker/blob/main/img/docker-2.png)

10. Проверьте вывод команд: ```ss -tlpn | grep 127.0.0.1:8080``` , ```docker port custom-nginx-t2```, ```curl http://127.0.0.1:8080```. Кратко объясните суть возникшей проблемы.

   - Изменился порт, на котором nginx слушает внутри контейнера — с 80 на 81, но:
   - Порт в контейнере больше не 80, но все еще проброщен порт хоста 127.0.0.1:8080 → контейнер:80
   - Значит — проброшенный порт не работает, т.к. внутри никто не слушает 80


![Задача 3.1](https://github.com/vladrabbit/docker/blob/main/img/docker-3.png)

![Задача 3.2](https://github.com/vladrabbit/docker/blob/main/img/docker-4.png)




## Задача 4


- Запустите первый контейнер из образа ***centos*** c любым тегом в фоновом режиме, подключив папку  текущий рабочий каталог ```$(pwd)``` на хостовой машине в ```/data``` контейнера, используя ключ -v.
..........................................................................................................................................................................................................
- Подключитесь во второй контейнер и отобразите листинг и содержание файлов в ```/data``` контейнера.


В качестве ответа приложите скриншоты консоли, где видно все введенные команды и их вывод.

## Задача 4 Решение

![Задача 4](https://github.com/vladrabbit/docker/blob/main/img/docker-5.png)


## Задача 5

1. Создайте отдельную директорию(например /tmp/netology/docker/task5) и 2 файла внутри него.
.....................................................................................................................................................

7. Удалите любой из манифестов компоуза(например compose.yaml).  Выполните команду "docker compose up -d". Прочитайте warning, объясните суть предупреждения и выполните предложенное действие. Погасите compose-проект ОДНОЙ(обязательно!!) командой.

В качестве ответа приложите скриншоты консоли, где видно все введенные команды и их вывод, файл compose.yaml , скриншот portainer c задеплоенным компоузом.

## Задача 5 Решение

1. Docker Compose нашёл оба файла, но выбрал compose.yaml, так как он имеет более высокий приоритет, если оба присутствуют в директории.
[Задача 5.1](https://github.com/vladrabbit/docker/blob/main/img/docker-6.1.png)

2. Отредактируйте файл compose.yaml так, чтобы были запущенны оба файла.

  ```yaml

  version: "3"
  include:
    - docker-compose.yaml
  services:
    portainer:
      network_mode: host
      image: portainer/portainer-ce:latest
      volumes:
        - /var/run/docker.sock:/var/run/docker.sock


  ```

3. Выполните в консоли вашей хостовой ОС необходимые команды чтобы залить образ custom-nginx как custom-nginx:latest в запущенное вами, локальное registry. Дополнительная документация: https://distribution.github.io/distribution/about/

[Задача 5.2](https://github.com/vladrabbit/docker/blob/main/img/docker-6.2.png)


6. Перейдите на страницу "http://127.0.0.1:9000/#!/2/docker/containers", выберите контейнер с nginx и нажмите на кнопку "inspect". В представлении <> Tree разверните поле "Config" и сделайте скриншот от поля "AppArmorProfile" до "Driver".

[Задача 5.3](https://github.com/vladrabbit/docker/blob/main/img/docker-6.3.png)
---


